---
title: "Reformat bike data"
author: "Sam Edelstein"
date: "December 17, 2015"
output: html_document
---

Open appropriate packages

```{r}
library(reshape)
library(lubridate)
library(dplyr)
```

Download data from [Nice Ride MN](https://www.niceridemn.org/data/). Read in data and make headers consistent so data frames can be combined
```{r}
bikeData2015 <- read.csv("Nice_ride_trip_history_2015_season.csv")
bikeData2014 <- read.csv("Nice_Ride_trip_history_2014_season.csv")
names(bikeData2015)<- c("StartDate", "StartStation", "StartStationNumber", "EndDate", "EndStation", "EndStationNumber", "TotalDuration", "AccountType")
names(bikeData2014)<- c("StartDate", "StartStation", "StartStationNumber", "EndDate", "EndStation", "EndStationNumber", "TotalDuration", "AccountType")
```
combine data frames
```{r}
bikeData <- rbind(bikeData2014, bikeData2015)
```
Get start time into datetime format and then round start times to the nearest hour
```{r}
bikeData$StartDate <- strptime(bikeData$StartDate, "%m/%d/%Y %H:%M")
bikeData$roundedHours <- as.character(round(bikeData$StartDate, "hours"))
```
Determine how many people rent a bike at each hour of the day, and what type of account they are on
```{r}
bikeDataCount <- as.data.frame(table(bikeData$roundedHours, bikeData$AccountType))
bikeDataCount<- reshape(bikeDataCount, timevar = "Var2", idvar="Var1", direction = "wide")
bikeDataCount$Unknown <- NULL
names(bikeDataCount) <- c("DateTime", "Casual", "Member")
bikeDataCount$TotalRiders <- bikeDataCount$Casual + bikeDataCount$Member
```
reformat to make datetime
```{r}
bikeDataCount$DateTime<-strptime(bikeDataCount$DateTime, "%Y-%m-%d %H:%M:%S")
```
Find if date is during the week or a weekend
```{r}
bikeDataCount$weekday <- weekdays(bikeDataCount$DateTime)
bikeDataCount$workingDay <- 1
bikeDataCount$workingDay[bikeDataCount$weekday == "Saturday" | bikeDataCount$weekday == "Sunday" ] <- 0
```

You now have hourly bike rides with associated attributes. 
